from itertools import product
from pwn import *
import string, pdb, signal, sys, time, requests, urllib3, re

def def_handler(sig, frame):
    print("\n\n[!] Saliendo...\n")
    sys.exit(1)

# Ctrl+C
signal.signal(signal.SIGINT, def_handler)


login_url = "http://127.0.0.1/login/index.php"

def trypreauth():
    s = requests.session()
    html=s.get(login_url).text
    logintoken = re.findall('<input type="hidden" name="logintoken" value="(.*?)">', html)[0]
    guest = {
                "logintoken": logintoken,
                "username": "guest",
                "password": "guest"
            }
    p1 = log.progress("Login as :")
    p1.status("guest")
    

    s.post(login_url, data=guest)
    


if __name__ == '__main__':

    trypreauth()
